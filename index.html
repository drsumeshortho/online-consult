function doPost(e) {
  try {
    const sheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName("HTML Submissions");

    const name = e?.parameter?.name || "undefined";
    const age = e?.parameter?.age || "undefined";
    const gender = e?.parameter?.gender || "undefined";
    const phone = e?.parameter?.phone || "undefined";
    const email = e?.parameter?.email || "undefined";
    const problem = e?.parameter?.problem || "undefined";
    const consultationDay = e?.parameter?.consultationDay || "undefined";
    const preferredTime = e?.parameter?.preferredTime || "undefined";
    const preferredExactTime = e?.parameter?.preferredExactTime || "Not mentioned";

    // Save to Google Sheet
    sheet.appendRow([
      new Date(),
      name,
      age,
      gender,
      phone,
      email,
      problem,
      consultationDay,
      preferredTime,
      preferredExactTime
    ]);

    // Email Alert
    MailApp.sendEmail({
      to: "santhosheks@gmail.com",
      subject: `New Online Consultation - ${name}`,
      body: `
ğŸ©º New Consultation Request

ğŸ“Œ Name: ${name}
ğŸ‚ Age: ${age}
ğŸ“± Phone: ${phone}
ğŸš» Gender: ${gender}
ğŸ¦´ Issue: ${problem}
ğŸ“… Preferred Day: ${consultationDay}
â° Time Slot: ${preferredTime}
ğŸ•’ Exact Time: ${preferredExactTime}
ğŸ“§ Email: ${email}
ğŸ•“ Timestamp: ${new Date().toLocaleString('en-IN')}
      `
    });

    return ContentService.createTextOutput("Success").setMimeType(ContentService.MimeType.TEXT);
  } catch (error) {
    Logger.log("âŒ doPost error: " + error);
    return ContentService.createTextOutput("Error: " + error).setMimeType(ContentService.MimeType.TEXT);
  }
}

// âœ… Optional: For browser testing or GET access
function doGet(e) {
  return HtmlService.createHtmlOutput("ğŸŸ¢ This Web App is Active. Form must be submitted via POST.");
}
